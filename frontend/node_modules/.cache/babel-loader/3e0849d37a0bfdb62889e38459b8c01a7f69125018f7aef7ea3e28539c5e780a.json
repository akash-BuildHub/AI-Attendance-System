{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const VideoPreview=_ref=>{let{camera,isLive,apiBase}=_ref;const[streamUrl,setStreamUrl]=useState(null);const[error,setError]=useState(null);const[isLoading,setIsLoading]=useState(false);useEffect(()=>{if(camera&&isLive){// For test preview (from CameraForm)\nif(camera.rtspUrl&&!camera.id){setStreamUrl(\"\".concat(apiBase,\"/preview-stream?rtspUrl=\").concat(encodeURIComponent(camera.rtspUrl)));}// For regular camera feed\nelse if(camera.id){setStreamUrl(\"\".concat(apiBase,\"/stream/\").concat(camera.id));}setError(null);setIsLoading(true);}else{setStreamUrl(null);setIsLoading(false);}},[camera,isLive,apiBase]);return/*#__PURE__*/_jsxs(\"div\",{className:\"video-preview\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"video-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"video-title\",children:camera?camera.name:\"No Camera Selected\"}),isLive&&/*#__PURE__*/_jsx(\"div\",{className:\"live-badge\",children:\"LIVE\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"video-placeholder\",children:streamUrl?/*#__PURE__*/_jsxs(_Fragment,{children:[isLoading&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',color:'#fff',zIndex:1,padding:'10px',background:'rgba(0,0,0,0.5)',borderRadius:'4px'},children:\"Loading stream...\"}),/*#__PURE__*/_jsx(\"img\",{src:streamUrl,alt:\"camera-live\",style:{width:\"100%\",height:\"100%\",objectFit:\"cover\",backgroundColor:\"#000\"},onLoad:()=>setIsLoading(false),onError:e=>{console.error(\"Error loading stream:\",e);setError(\"Unable to load video stream\");setIsLoading(false);}})]}):camera?/*#__PURE__*/_jsxs(\"div\",{style:{color:\"#777\",padding:\"20px\",textAlign:\"center\"},children:[error||\"Click 'Test' to check camera connection\",isLive&&!streamUrl&&/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"12px\",marginTop:\"8px\"},children:\"Starting face recognition feed...\"})]}):/*#__PURE__*/_jsx(\"div\",{style:{color:\"#777\",padding:\"20px\",textAlign:\"center\"},children:\"Select a camera to preview live feed\"})})]});};export default VideoPreview;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","VideoPreview","_ref","camera","isLive","apiBase","streamUrl","setStreamUrl","error","setError","isLoading","setIsLoading","rtspUrl","id","concat","encodeURIComponent","className","children","name","style","position","color","zIndex","padding","background","borderRadius","src","alt","width","height","objectFit","backgroundColor","onLoad","onError","e","console","textAlign","fontSize","marginTop"],"sources":["/home/owlytics/Desktop/Grow AI/frontend/src/components/VideoPreview.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\n\r\nconst VideoPreview = ({ camera, isLive, apiBase }) => {\r\n  const [streamUrl, setStreamUrl] = useState(null);\r\n  const [error, setError] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (camera && isLive) {\r\n      // For test preview (from CameraForm)\r\n      if (camera.rtspUrl && !camera.id) {\r\n        setStreamUrl(`${apiBase}/preview-stream?rtspUrl=${encodeURIComponent(camera.rtspUrl)}`);\r\n      }\r\n      // For regular camera feed\r\n      else if (camera.id) {\r\n        setStreamUrl(`${apiBase}/stream/${camera.id}`);\r\n      }\r\n      setError(null);\r\n      setIsLoading(true);\r\n    } else {\r\n      setStreamUrl(null);\r\n      setIsLoading(false);\r\n    }\r\n  }, [camera, isLive, apiBase]);\r\n\r\n  return (\r\n    <div className=\"video-preview\">\r\n      <div className=\"video-header\">\r\n        <div className=\"video-title\">\r\n          {camera ? camera.name : \"No Camera Selected\"}\r\n        </div>\r\n        {isLive && <div className=\"live-badge\">LIVE</div>}\r\n      </div>\r\n\r\n      <div className=\"video-placeholder\">\r\n        {streamUrl ? (\r\n          <>\r\n            {isLoading && (\r\n              <div style={{\r\n                position: 'absolute',\r\n                color: '#fff',\r\n                zIndex: 1,\r\n                padding: '10px',\r\n                background: 'rgba(0,0,0,0.5)',\r\n                borderRadius: '4px'\r\n              }}>\r\n                Loading stream...\r\n              </div>\r\n            )}\r\n            <img\r\n              src={streamUrl}\r\n              alt=\"camera-live\"\r\n              style={{ \r\n                width: \"100%\", \r\n                height: \"100%\", \r\n                objectFit: \"cover\",\r\n                backgroundColor: \"#000\"\r\n              }}\r\n              onLoad={() => setIsLoading(false)}\r\n              onError={(e) => {\r\n                console.error(\"Error loading stream:\", e);\r\n                setError(\"Unable to load video stream\");\r\n                setIsLoading(false);\r\n              }}\r\n            />\r\n          </>\r\n        ) : camera ? (\r\n          <div style={{ color: \"#777\", padding: \"20px\", textAlign: \"center\" }}>\r\n            {error || \"Click 'Test' to check camera connection\"}\r\n            {isLive && !streamUrl && (\r\n              <div style={{ fontSize: \"12px\", marginTop: \"8px\" }}>\r\n                Starting face recognition feed...\r\n              </div>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          <div style={{ color: \"#777\", padding: \"20px\", textAlign: \"center\" }}>\r\n            Select a camera to preview live feed\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoPreview;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}